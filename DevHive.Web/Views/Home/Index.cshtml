@model DevHive.Web.Models.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Home Page";
    int prevPage = Model.PageNumber - 1;
    int nextPage = Model.PageNumber + 1;
}

<section class="hero-section">
    <div class="container col-xxl-8 px-5 py-5">
        <div class="row align-items-center g-5">

            <!-- LEFT: text -->
            <div class="col-12 col-lg-6">
                <h1 class="display-6 fw-bold lh-1 mb-3">
                    DevHive - Insights For Modern Developers
                </h1>
                <p class="lead hero-subtitle">
                    Join DevHive to explore a wide range of coding topics,
                    from web fundamentals like HTML and CSS to cutting-edge areas like AI and machine learning.<br>
                    Register now to join our community, engage with fellow developers,
                    and unlock the ability to like and comment on posts.
                </p>
            </div>

            <div class="col-12 col-lg-6">
                <div class="hero-img-wrap">
                    <img src="https://res-console.cloudinary.com/dtx49glp3/thumbnails/v1/image/upload/v1766793192/Q2hhdEdQVF9JbWFnZV9EZWNfMjdfMjAyNV8wMV81MV81NV9BTV9ia3VuZmM=/preview"
                         alt="DevHive - Insights For Modern Developers"
                         class="hero-img w-100" />
                </div>
            </div>
        </div>
    </div>
</section>

<hr class="section-divider" />

<section class="tags-section">
    <div class="container px-5">
        <div class="container col-xxl-8 px-5 tags-box">
            <div class="tags-header">
                <h2 class="section-title">Browse by topic</h2>
                <p class="section-hint">Filter posts by a specific technology</p>
            </div>

            <section id="tagsSection">
                <div class="tags-row">
                    @if (Model.Tags != null && Model.Tags.Any())
                    {
                        <div class="tags-row">
                            @foreach (var tag in Model.Tags)
                            {
                                <a class="badge bg-dark text-white me-2 mb-2"
                                   asp-controller="Home"
                                   asp-action="Index"
                                   asp-route-tag="@tag.Name"
                                   asp-route-pageNumber="1"
                                   asp-route-pageSize="@Model.PageSize"
                                   asp-fragment="posts">
                                    @tag.Name
                                </a>
                            }
                        </div>
                    }

                    <hr />
                </div>
            </section>
        </div>
    </div>
</section>

<hr class="section-divider" />

<section class="posts-section">
    <div class="container col-xl-7 px-5 pb-5">
        <div class="posts-header">
            <h1 class="section-title" id="posts">Latest Posts</h1>
        </div>

        @if (Model.BlogPosts != null && Model.BlogPosts.Any())
        {
            foreach (var blogPost in Model.BlogPosts)
            {
                <div class="mb-5 blog-card p-3">
                    <img src="@blogPost.FeaturedImageUrl" alt="@blogPost.Heading"
                         class="blog-card-img" />

                    <h2 class="mb-4">@blogPost.Heading</h2>
                    <p class="mb-4">
                        Author: @blogPost.Author
                        <br />
                        Published Date: @blogPost.PublishedDate.ToShortDateString()
                    </p>


                    @if (blogPost.Tags != null && blogPost.Tags.Any())
                    {
                        <p class="mb-4">
                            @foreach (var tag in blogPost.Tags)
                            {
                                <span class="badge bg-secondary me-1">@tag.Name</span>
                            }
                        </p>
                    }

                    <p class="mb-4">@blogPost.ShortDescription</p>

                    <a class="btn btn-dark"
                       asp-area=""
                       asp-controller="Blogs"
                       asp-action="Index"
                       asp-route-urlHandle="@blogPost.UrlHandle">Read More</a>
                </div>

            }
        }
        else
        {
            <p>No posts found.</p>
        }

        @if (Model.TotalPages >= 1)
        {
            prevPage = Model.PageNumber - 1;
            nextPage = Model.PageNumber + 1;

            <nav aria-label="Posts pagination" class="mt-4">
                <ul class="pagination justify-content-center">

                    <li class="page-item @(Model.PageNumber == 1 ? "disabled" : "")">
                        <a class="page-link"
                           asp-controller="Home"
                           asp-action="Index"
                           asp-route-tag="@Model.SelectedTag"
                           asp-route-pageNumber="@prevPage"
                           asp-route-pageSize="@Model.PageSize"
                           asp-fragment="posts">
                            Previous
                        </a>
                    </li>

                    @if (Model.TotalPages > 1)
                    {
                        @for (int i = 1; i <= Model.TotalPages; i++)
                        {
                            <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                                <a class="page-link"
                                   asp-controller="Home"
                                   asp-action="Index"
                                   asp-route-tag="@Model.SelectedTag"
                                   asp-route-pageNumber="@i"
                                   asp-route-pageSize="@Model.PageSize"
                                   asp-fragment="posts">
                                    @i
                                </a>
                            </li>
                        }
                    }
                    else
                    {
                        //for only one page pag
                        <li class="page-item active">
                            <span class="page-link">1</span>
                        </li>
                    }

                    <li class="page-item @(Model.PageNumber == Model.TotalPages ? "disabled" : "")">
                        <a class="page-link"
                           asp-controller="Home"
                           asp-action="Index"
                           asp-route-tag="@Model.SelectedTag"
                           asp-route-pageNumber="@nextPage"
                           asp-route-pageSize="@Model.PageSize"
                           asp-fragment="posts">
                            Next
                        </a>
                    </li>

                </ul>
            </nav>
        }
    </div>
</section>
